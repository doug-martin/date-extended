/*! date-extended - v0.0.1 - 2013-01-16
* Copyright (c) 2013 Doug Martin; Licensed MIT */
(function(){"use strict";function e(e,t){function n(e,t,n,r){e=""+e,n=n||" ";var i=e.length;while(i<t)r?e+=n:e=n+e,i++;return e}function r(e,n,i){var s=e;if(t.isString(s)){if(e.length>n)if(i){var o=e.length;s=e.substring(o-n,o)}else s=e.substring(0,n)}else s=r(""+s,n);return s}function i(e,n,r){if(!t.isArray(e)||typeof n!="function")throw new TypeError;var i=Object(e),s=i.length>>>0;for(var o=0;o<s;o++)if(o in i&&!n.call(r,i[o],o,i))return!1;return!0}function w(e,t){return T.difference(new Date(e.getFullYear(),0,1,e.getHours()),e,null,t)+1}function E(e,t,n){t=t||0;var r=e[n?"getUTCFullYear":"getFullYear"](),i=(new Date(r,0,1)).getDay(),s=(i-t+7)%7,o=a((w(e)+s-1)/7);return i===t&&o++,o}function S(e){var t=e.toString(),n="",r=t.indexOf("(");return r>-1&&(n=t.substring(++r,t.indexOf(")"))),n}function x(e,t){return e.replace(/([a-z])\1*/ig,function(e){var n,r=e.charAt(0),i=e.length,s="0?",o="0{0,2}";if(r==="y")n="\\d{2,4}";else if(r==="M")n=i>2?"\\S+?":"1[0-2]|"+s+"[1-9]";else if(r==="D")n="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+o+"[1-9][0-9]|"+s+"[1-9]";else if(r==="d")n="3[01]|[12]\\d|"+s+"[1-9]";else if(r==="w")n="[1-4][0-9]|5[0-3]|"+s+"[1-9]";else if(r==="E")n="\\S+";else if(r==="h")n="1[0-2]|"+s+"[1-9]";else if(r==="K")n="1[01]|"+s+"\\d";else if(r==="H")n="1\\d|2[0-3]|"+s+"\\d";else if(r==="k")n="1\\d|2[0-4]|"+s+"[1-9]";else if(r==="m"||r==="s")n="[0-5]\\d";else if(r==="S")n="\\d{"+i+"}";else if(r==="a"){var u="AM",a="PM";n=u+"|"+a,u!==u.toLowerCase()&&(n+="|"+u.toLowerCase()),a!==a.toLowerCase()&&(n+="|"+a.toLowerCase()),n=n.replace(/\./g,"\\.")}else r==="v"||r==="z"||r==="Z"||r==="G"||r==="q"||r==="Q"?n=".*":n=r===" "?"\\s*":r+"*";return t&&t.push(e),"("+n+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}function C(e){N[e+"sFromNow"]=function(t){return T.add(new Date,e,t)},N[e+"sAgo"]=function(t){return T.add(new Date,e,-t)}}var s=function(){function r(e,t,r){return e=e.replace(/s$/,""),n.hasOwnProperty(e)?n[e](t,r):[r,"UTC"+e.charAt(0).toUpperCase()+e.substring(1)+"s",!1]}function s(e,n,r,s){return e=e.replace(/s$/,""),t(i[e](n,r,s))}var e=Math.floor,t=Math.round,n={day:function(t,n){return[n,"Date",!1]},weekday:function(t,n){var r,i,s=n%5,o=t.getDay(),u=0;s?(r=s,i=parseInt(n/5,10)):(r=n>0?5:-5,i=n>0?(n-5)/5:(n+5)/5),o===6&&n>0?u=1:o===0&&n<0&&(u=-1);var a=o+r;if(a===0||a===6)u=n>0?2:-2;return[7*i+r+u,"Date",!1]},year:function(t,n){return[n,"FullYear",!0]},week:function(t,n){return[n*7,"Date",!1]},quarter:function(t,n){return[n*3,"Month",!0]},month:function(t,n){return[n,"Month",!0]}},i={quarter:function(n,r,i){var s=r.getFullYear()-n.getFullYear(),o=n[i?"getUTCMonth":"getMonth"](),u=r[i?"getUTCMonth":"getMonth"](),a=e(o/3)+1,f=e(u/3)+1;return f+=s*4,f-a},weekday:function(t,n,r){var i=s("day",t,n,r),o,u=i%7;if(u===0)i=s("week",t,n,r)*5;else{var a=0,f=t[r?"getUTCDay":"getDay"](),l=n[r?"getUTCDay":"getDay"]();o=parseInt(i/7,10);var c=new Date(t);c.setDate(c[r?"getUTCDate":"getDate"]()+o*7);var h=c[r?"getUTCDay":"getDay"]();if(i>0){if(f===6||l===6)a=-1;else if(f===0)a=0;else if(l===0||h+u>5)a=-2}else if(i<0)if(f===6)a=0;else if(f===0||l===0)a=1;else if(l===6||h+u<0)a=2;i+=a,i-=o*2}return i},year:function(e,t){return t.getFullYear()-e.getFullYear()},month:function(e,t,n){var r=e[n?"getUTCMonth":"getMonth"](),i=t[n?"getUTCMonth":"getMonth"]();return i-r+(t.getFullYear()-e.getFullYear())*12},week:function(e,n,r){return t(s("day",e,n,r)/7)},day:function(e,t){return 1.1574074074074074e-8*(t.getTime()-e.getTime())},hour:function(e,t){return 2.7777777777777776e-7*(t.getTime()-e.getTime())},minute:function(e,t){return 16666666666666667e-21*(t.getTime()-e.getTime())},second:function(e,t){return.001*(t.getTime()-e.getTime())},millisecond:function(e,t){return t.getTime()-e.getTime()}};return{addTransform:r,differenceTransform:s}}(),o=s.addTransform,u=s.differenceTransform,a=Math.floor,f=Math.round,l=Math.min,c=Math.pow,h=Math.ceil,p=Math.abs,d=["January","February","March","April","May","June","July","August","September","October","November","December"],v=["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."],m=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],y=["Before Christ","Anno Domini"],b=["BC","AD"],T={getDaysInMonth:function(e){var t=e.getMonth(),n=[31,28,31,30,31,30,31,31,30,31,30,31];return t===1&&T.isLeapYear(e)?29:n[t]},isLeapYear:function(e,t){var n=e[t?"getUTCFullYear":"getFullYear"]();return n%400===0||n%4===0&&n%100!==0},isWeekend:function(e,t){var n=(e||new Date)[t?"getUTCDay":"getDay"]();return n===0||n===6},getTimezoneName:S,compare:function(e,t,n){return e=new Date(e),t=new Date(t||new Date),n==="date"?(e.setHours(0,0,0,0),t.setHours(0,0,0,0)):n==="time"&&(e.setFullYear(0,0,0),t.setFullYear(0,0,0)),e>t?1:e<t?-1:0},add:function(e,t,n){var r=o(t,e,n||0);n=r[0];var i=r[1],s=new Date(e),u=r[2];return i&&s["set"+i](s["get"+i]()+n),u&&s.getDate()<e.getDate()&&s.setDate(0),s},difference:function(e,t,n,r){return t=t||new Date,n=n||"day",u(n,e,t,r)},format:function(e,t,i){i=i||!1;var s,o,u,l,x,T,N,C;return i?(s=e.getUTCFullYear(),o=e.getUTCMonth(),u=e.getUTCDay(),l=e.getUTCDate(),x=e.getUTCHours(),T=e.getUTCMinutes(),N=e.getUTCSeconds(),C=e.getUTCMilliseconds()):(s=e.getFullYear(),o=e.getMonth(),l=e.getDate(),u=e.getDay(),x=e.getHours(),T=e.getMinutes(),N=e.getSeconds(),C=e.getMilliseconds()),t.replace(/([A-Za-z])\1*/g,function(t){var k,L,A=t.charAt(0),O=t.length;if(A==="d")k=""+l,L=!0;else if(A==="H"&&!k)k=""+x,L=!0;else if(A==="m"&&!k)k=""+T,L=!0;else if(A==="s")k||(k=""+N),L=!0;else if(A==="G")k=(O<4?b:y)[s<0?0:1];else if(A==="y")k=s,O>1&&(O===2?k=r(""+k,2,!0):L=!0);else if(A.toUpperCase()==="Q")k=h((o+1)/3),L=!0;else if(A==="M")O<3?(k=o+1,L=!0):k=(O===3?v:d)[o];else if(A==="w")k=E(e,0,i),L=!0;else if(A==="D")k=w(e,i),L=!0;else if(A==="E")O<3?(k=u+1,L=!0):k=(O===-3?g:m)[u];else if(A==="a")k=x<12?"AM":"PM";else if(A==="h")k=x%12||12,L=!0;else if(A==="K")k=x%12,L=!0;else if(A==="k")k=x||24,L=!0;else if(A==="S")k=f(C*c(10,O-3)),L=!0;else if(A==="z"||A==="v"||A==="Z"){k=S(e),(A==="z"||A==="v")&&!k&&(O=4);if(!k||A==="Z"){var M=e.getTimezoneOffset(),_=[M>=0?"-":"+",n(a(p(M)/60),2,"0"),n(p(M)%60,2,"0")];O===4&&(_.splice(0,0,"GMT"),_.splice(3,0,":")),k=_.join("")}}else k=t;return L&&(k=n(k,O,"0")),k})}},N={},k=["year","month","day","hour","minute","second"],L;for(var A=0,O=k.length;A<O;A++)C(k[A]);var M={parseDate:function(e,t){if(!t)throw new Error("format required when calling dateExtender.parse");var n=[],r=x(t,n),s=new RegExp("^"+r+"$","i"),o=s.exec(e);if(!o)return null;var u=[1970,0,1,0,0,0,0],a="",f=i(o,function(e,t){if(t){var r=n[t-1],i=r.length,s=r.charAt(0);if(s==="y")if(e<100){e=parseInt(e,10);var o=""+(new Date).getFullYear(),f=o.substring(0,2)*100,c=l(o.substring(2,4)+20,99);u[0]=e<c?f+e:f-100+e}else u[0]=e;else if(s==="M"){if(i>2){var h=d,p,y;i===3&&(h=v),e=e.replace(".","").toLowerCase();var b=!1;for(p=0,y=h.length;p<y&&!b;p++){var w=h[p].replace(".","").toLocaleLowerCase();w===e&&(e=p,b=!0)}if(!b)return!1}else e--;u[1]=e}else if(s==="E"||s==="e"){var E=m;i===3&&(E=g),e=e.toLowerCase(),E=E.map(function(e){return e.toLowerCase()});var S=E.indexOf(e);if(S===-1){e=parseInt(e,10);if(isNaN(e)||e>E.length)return!1}else e=S}else if(s==="D"||s==="d")s==="D"&&(u[1]=0),u[2]=e;else if(s==="a"){var x="am",T="pm",N=/\./g;e=e.replace(N,"").toLowerCase(),a=e===T?"p":e===x?"a":""}else s==="k"||s==="h"||s==="H"||s==="K"?(s==="k"&&+e===24&&(e=0),u[3]=e):s==="m"?u[4]=e:s==="s"?u[5]=e:s==="S"&&(u[6]=e)}return!0});if(f){var c=+u[3];a==="p"&&c<12?u[3]=c+12:a==="a"&&c===12&&(u[3]=0);var h=new Date(u[0],u[1],u[2],u[3],u[4],u[5],u[6]),p=n.indexOf("d")!==-1,y=n.indexOf("M")!==-1,b=u[1],w=u[2],E=h.getMonth(),S=h.getDate();return y&&E>b||p&&S>w?null:h}return null}},A,_=e.define(t.isDate,T).define(t.isString,M).define(t.isNumber,N);for(A in T)T.hasOwnProperty(A)&&(_[A]=T[A]);for(A in M)M.hasOwnProperty(A)&&(_[A]=M[A]);for(A in N)N.hasOwnProperty(A)&&(_[A]=N[A]);return _}"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(module.exports=e(require("extender"),require("is-extended"))):"function"==typeof define?define(["require"],function(t){return e(t("extender"),t("is-extended"))}):this.dateExtended=e(this.extender,this.isExtended)}).call(this);